---

- block:
    - name: Check for modified docker_files
      raw: git status | grep Dockerfile | wc -l
      register: files_changed

    - name: Stage, commit and push files
      raw: "git add ../*Dockerfile && git commit -m 'Dockerfiles generated by ansible-playbook' && git push"
      when: files_changed.stdout | replace('\n', '') != '0'
  rescue:
    - debug: msg="Git commit of docker files has failed, please check the ansible logs"

